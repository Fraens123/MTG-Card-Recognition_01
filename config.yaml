paths:
  scryfall_dir: ./data/scryfall_images
  camera_dir: ./data/camera_images
  models_dir: ./models
  embeddings_dir: ./embeddings
  output_dir: ./output_matches
  debug_dir: ./debug

images:
  full_card_size: [224, 320]  # [width, height]
  #full_card_size: [320, 448]  # [width, height]
  full_crop:
    x_min: 0.0
    y_min: 0.0
    x_max: 1.0
    y_max: 1.0
    keep_aspect: true

encoder:
  type: resnet18    # resnet18
  emb_dim: 1024     # Dimension bleibt unveraendert

training:
  coarse:
    batch_size: 192  # resnet18
    #batch_size: 160 # resnet50
    epochs: 20 # resnet18
    #epochs: 12  # resnet50
    lr: 0.001
    num_workers: 8
    cache_images: true
    cache_size: 4096
    augment:
      rotation_deg: 1
      brightness: [0.9, 1.1]
      contrast: [0.9, 1.1]
      blur_prob: 0.1
      noise_std: 0.02
  fine:
    batch_size: 64
    epochs: 10
    lr: 0.0001
    margin: 0.35
    freeze_ratio: 0.6
    num_workers: 8
    cache_images: true
    cache_size: 4096
    use_camera_images: false
    augment:
      camera_like: true
      rotation_deg: 2
      brightness: [0.8, 1.2]
      contrast: [0.85, 1.15]
      blur_prob: 0.3
      noise_std: 0.05
      camera_like_strength: 1

debug:
  augmentation_preview_dir: ./debug/augment_preview
  camera_crop_dump_dir: ./debug/camera_crops
  camera_crop_dump_count: 10

recognition:
  top_k: 3
  threshold: 0.55

database:
  sqlite_path: tcg_database/database/karten.db

vector:
  dimension: 1024

model:
  embed_dim: 1024

hardware:
  use_cuda: true

camera:
  card_roi:
    x_min: 0.0
    y_min: 0.0
    x_max: 1.0
    y_max: 1.0

camera_augmentor:
  enabled: true
  brightness_min: 0.55
  brightness_max: 1.05
  contrast_min: 0.8
  contrast_max: 1.1
  gamma_min: 0.9
  gamma_max: 1.1
  blur_sigma_min: 0.2
  blur_sigma_max: 3.0
  noise_std_max: 0.02
  tilt_deg_max: 1
  perspective_max: 0.03
  color_temp_shift_max: 0.08
  saturation_min: 0.9
  saturation_max: 1.1
  hue_shift_max: 3

embedding_export_runtime:
  model_path: ./models/encoder_fine.pt
  use_augmentations: true
  num_augmentations: 10
  use_centroid: true
  append_individual: false
  append_centroid: false
  export_batch_size: 64
  num_workers: 4

embedding_export_analysis:
  model_path: ./models/encoder_fine.pt
  use_augmentations: true
  num_augmentations: 10
  use_centroid: false
  append_individual: true
  append_centroid: true
  export_batch_size: 64
  num_workers: 4

analysis:
  thresholds:
    spread_max: 0.90   # Flag, wenn intra_max_dist > spread_max
    overlap: 0.60      # Flag, wenn nearest_neighbor_dist < overlap

ocr_crops:
  name:
    x: 100
    y: 150
    w: 2400 
    h: 250
  collector:
    x: 100
    y: 3250
    w: 500
    h: 100
  setid:
    x: 100
    y: 3320
    w: 500
    h: 100
