paths:
  scryfall_dir: ./data/scryfall_images/subsets/train_20k_en_de
  camera_dir: ./data/camera_images
  models_dir: ./models
  embeddings_dir: ./embeddings
  output_dir: ./output_matches
  debug_dir: ./debug
images:
  full_card_size:
  - 224
  - 320
camera:
  debug_crops:
    enabled: false
    save_limit: 10
    output_dir: ./debug/domain_preview
encoder:
  type: resnet50
  emb_dim: 1024
training:
  coarse:
    model_filename: encoder_coarse_20k_resnet50.pt
    batch_size: 96
    epochs: 10
    lr: 0.0004
    num_workers: 8
    cache_images: true
    cache_size: 8000
    scheduler:
      type: warmup_cosine
      warmup_epochs: 2
      warmup_start_factor: 0.2
      min_lr: 5.0e-05
    augment:
      rotation_deg: 1
      brightness:
      - 0.9
      - 1.1
      contrast:
      - 0.9
      - 1.1
      blur_prob: 0.1
      noise_std: 0.02
  fine:
    model_filename: encoder_fine_20k_resnet50.pt
    batch_size: 32
    epochs: 6
    lr: 0.00012
    margin: 0.4
    freeze_ratio: 0.5
    triplet_weight: 1.0
    ce_weight: 0.3
    num_workers: 8
    cache_images: true
    cache_size: 6000
    use_camera_images: false
    hard_negatives:
      enabled: false
      top_k: 20
      file: debug/hard_negatives_20k.json
    scheduler:
      type: warmup_cosine
      warmup_epochs: 2
      warmup_start_factor: 0.2
      min_lr: 2.0e-05
    augment:
      camera_like: true
      camera_like_strength: 1.0
      brightness: [0.90, 1.10]
      contrast: [0.90, 1.10]
      saturation: [0.95, 1.05]
      color_temperature_range: [0.95, 1.05]
      gamma_range: [0.95, 1.05]
      rotation_deg: 1.0
      perspective: 0.0
      shadow: 0.0
      noise_std: 0.01
      blur_prob: 0.05

database:
  sqlite_path: tcg_database/database/karten.db
  scenario: train20k
  clear_all_embeddings: true
vector:
  dimension: 1024
model:
  embed_dim: 1024
hardware:
  use_cuda: true
embedding_export_runtime:
  model_path: ./models/encoder_fine_20k_resnet50.pt
  use_augmentations: true     # wichtig!
  num_augmentations: 2        # erstmal moderat lassen
  use_centroid: true          # nur 1 Vektor pro Karte in DB
  append_individual: false    # keine einzelnen Aug-Vektoren speichern
  append_centroid: false      # Zentroid wird trotzdem gespeichert (use_centroid)
  export_batch_size: 32
  num_workers: 2
camera_augmentor:
  # Starke, optimierte Kamera-Augmentierungen NUR f√ºr Analysis-Export
  enabled: true
  camera_like: true
  camera_like_strength: 1.0
  brightness: [0.8226, 1.1478]
  contrast: [0.9700, 1.3280]
  saturation: [0.6441, 1.1688]
  color_temperature_range: [0.8657, 1.0696]
  gamma_range: [0.8852, 1.0745]
  rotation_deg: 4.0181
  perspective: 0.0879
  shadow: 0.2199
  blur_prob: 0.3116
  noise_std: 0.0277
embedding_export_analysis:
  model_path: ./models/encoder_fine_20k_resnet50.pt
  use_augmentations: true
  num_augmentations: 2
  use_centroid: false
  append_individual: true
  append_centroid: true
  export_batch_size: 32
  num_workers: 4
analysis:
  oracle_summary_file: debug/oracle_cluster_summary_20k.json
recognition:
  top_k: 5
  threshold: 0.2
  use_ocr: false
pipeline:
  scenario: full_no_hardneg
  scenarios:
    final_20k_no_hardneg:
    - fine
    - export_runtime_fine
    - export_analysis_fine
    - analyze_embeddings
    - oracle_analysis_final
    full_no_hardneg:
    - coarse
    - fine
    - export_runtime_fine
    - export_analysis_fine
    - oracle_analysis_final
    - analyze_embeddings
    full:
    - coarse
    - export_analysis_coarse
    - oracle_analysis_for_hardneg
    - build_hard_negatives
    - fine
    - export_runtime_fine
    - export_analysis_fine
    - analyze_embeddings
    - oracle_analysis_final
    fast_debug:
    - coarse
    - fine
    - export_runtime_fine
    only_export_runtime:
    - export_runtime_fine
